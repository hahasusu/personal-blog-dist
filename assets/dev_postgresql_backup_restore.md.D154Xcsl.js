import{_ as s,c as a,o as p,a4 as i}from"./chunks/framework.BE4fazHS.js";const F=JSON.parse('{"title":"PostgreSQL 备份与还原","description":"","frontmatter":{},"headers":[],"relativePath":"dev/postgresql_backup_restore.md","filePath":"dev/postgresql_backup_restore.md"}'),n={name:"dev/postgresql_backup_restore.md"},e=i(`<h1 id="postgresql-备份与还原" tabindex="-1">PostgreSQL 备份与还原 <a class="header-anchor" href="#postgresql-备份与还原" aria-label="Permalink to &quot;PostgreSQL 备份与还原&quot;">​</a></h1><h2 id="pg-dump" tabindex="-1">pg_dump <a class="header-anchor" href="#pg-dump" aria-label="Permalink to &quot;pg_dump&quot;">​</a></h2><blockquote><p>pg_dump 将一个PostgreSQL数据库转储到一个脚本文件或者其它归档文件中</p></blockquote><p>官方文档： <a href="https://www.postgresql.org/docs/12/app-pgdump.html" target="_blank" rel="noreferrer">https://www.postgresql.org/docs/12/app-pgdump.html</a></p><p>pg_dump常用参数：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>## 通用选项：</span></span>
<span class="line"><span>-f, --file=FILENAME          输出文件名或目录名</span></span>
<span class="line"><span>-F, --format=c|d|t|p         输出文件格式（自定义、目录格式、tar包格式、纯文本）</span></span>
<span class="line"><span>-j, --jobs=NUM               使用多个并行作业进行转储</span></span>
<span class="line"><span>-v, --verbose                详细信息模式</span></span>
<span class="line"><span></span></span>
<span class="line"><span>## 详细模式：</span></span>
<span class="line"><span>-b, --blobs                  在转储中包括大对象</span></span>
<span class="line"><span>-c, --clean                  在重新创建之前，先清除（删除）数据库对象</span></span>
<span class="line"><span>-C, --create                 在转储中包括命令,以便创建数据库（包括建库语句，无需在导入之前先建数据库）</span></span>
<span class="line"><span>-n, --schema=SCHEMA          只转储指定名称的模式</span></span>
<span class="line"><span>-N, --exclude-schema=SCHEMA  不转储已命名的模式</span></span>
<span class="line"><span>-t, --table=TABLE            只转储指定名称的表</span></span>
<span class="line"><span>--column-inserts             以带有列名的INSERT命令形式转储数据</span></span>
<span class="line"><span></span></span>
<span class="line"><span>## 控制输出内容选项：</span></span>
<span class="line"><span>-d, --dbname=DBNAME          数据库名</span></span>
<span class="line"><span>-h, --host=HOSTNAME          数据库服务器的主机名或套接字目录</span></span>
<span class="line"><span>-p, --port=PORT              数据库服务器的端口号</span></span>
<span class="line"><span>-U, --username=NAME          以指定的数据库用户联接</span></span>
<span class="line"><span>-w, --no-password            永远不提示输入口令</span></span>
<span class="line"><span>-W, --password               强制口令提示 (自动)</span></span>
<span class="line"><span>--role=ROLENAME              在转储之前执行SET ROLE命令</span></span></code></pre></div><p>备份：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5432</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  epgis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pgis.pgdump</span></span></code></pre></div><p>还原：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> newDBname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  newDBname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pgis.pgdump</span></span></code></pre></div><p>linux 下先查看postgre安装路径</p><p>whereis postgres</p><p>在切换到路径下执行，一般在/usr/bin 路径下</p><h2 id="pg-restore" tabindex="-1">pg_restore <a class="header-anchor" href="#pg-restore" aria-label="Permalink to &quot;pg_restore&quot;">​</a></h2><p>pg_dump -Ft 为压缩为tar模式时，只能用pg_restore恢复</p><p>-Fc备份为二进制格式, 压缩存储. 并且可被 pg_restore 用于精细还原</p><p>备份：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  epgis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pgis.tar</span></span></code></pre></div><p>恢复：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_restore</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> epgis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pgis.tar</span></span></code></pre></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><p><a href="https://tool.4xseo.com/a/2435.html" target="_blank" rel="noreferrer">https://tool.4xseo.com/a/2435.html</a></p>`,22),t=[e];function l(h,r,k,o,d,g){return p(),a("div",null,t)}const C=s(n,[["render",l]]);export{F as __pageData,C as default};
